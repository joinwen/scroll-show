'use strict';

/**
 * 获取 dom 属性
 */
const getStyle = (ele, attr) => {
  try{
    return document.defaultView.getComputedStyle(ele)[attr];
  }catch (e) {
    return 0;
  }
};

/**
 * 字符串转数字
 */
const toNumber = (str) => {
  return Number.parseInt(str);
};

/**
 * 获取元素的 pageY
 */
const pageY = (ele) => {
  let y = 0;
  while(ele.offsetParent) {
    y += ele.offsetTop;
    ele = ele.offsetParent;
  }
  return y;
};

/**
 * 获取 src 在 target 元素里的 clientY
 * @param target
 * @param src
 */
const clientY = (target, src) => {
  let srcY = pageY(src),
    targetY = pageY(target),
    scrollY = target.scrollTop || 0;     // 没有滚动 scrollY = 0
  return srcY - targetY - scrollY;
};

const defaultOptions = {
  wrapped: null,
  child: null,
  border: true,
  forward: 0,
  cb: () => {}
};
const removeBorder = (wrapped, y) => {
  let bt = getStyle(wrapped, "border-top");
  return y - toNumber(bt);
};

const judgeY = (y, options) => {
  let wrapped = options.wrapped,
    child = options.child,
    callback = options.cb,
    border = options.border,
    forward = options.forward;
  y += forward;
  if(y <= 0) {
    let newY = y + (border ? child.offsetHeight : child.clientHeight);
    console.log(newY);
    if(newY > 0) {
      callback(child, true);
    } else {
      callback(child, false);
    }
  } else {
    if(y <= (wrapped.clientHeight) && y >= 2 * forward) {
      callback(child, true);
    } else {
      callback(child, false);
    }
  }
};
const scrollShow = (options) => {
  options = Object.assign(defaultOptions, options);
  let y = clientY(options.wrapped, options.child);
  y = removeBorder(options.wrapped, y);       // wrapped 元素的 border 宽度会计算进去，在这里减掉
  judgeY(y, options);
};

module.exports = scrollShow;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2Nyb2xsLXNob3cuY2pzLmpzIiwic291cmNlcyI6WyIuLi9zcmMvdG9vbHMvaW5kZXguanMiLCIuLi9zcmMvY29yZS9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICog6I635Y+WIGRvbSDlsZ7mgKdcclxuICovXHJcbmNvbnN0IGdldFN0eWxlID0gKGVsZSwgYXR0cikgPT4ge1xyXG4gIHRyeXtcclxuICAgIHJldHVybiBkb2N1bWVudC5kZWZhdWx0Vmlldy5nZXRDb21wdXRlZFN0eWxlKGVsZSlbYXR0cl07XHJcbiAgfWNhdGNoIChlKSB7XHJcbiAgICByZXR1cm4gMDtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiDlrZfnrKbkuLLovazmlbDlrZdcclxuICovXHJcbmNvbnN0IHRvTnVtYmVyID0gKHN0cikgPT4ge1xyXG4gIHJldHVybiBOdW1iZXIucGFyc2VJbnQoc3RyKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIOiOt+WPliDpq5jluqZcclxuICovXHJcbmNvbnN0IGdldEhlaWdodCA9IChlbGUpID0+IHtcclxuICBsZXQgaGVpZ2h0ID0gZ2V0U3R5bGUoZWxlLFwiaGVpZ2h0XCIpO1xyXG4gIHJldHVybiB0b051bWJlcihoZWlnaHQpO1xyXG59XHJcblxyXG4vKipcclxuICog6I635Y+WIOmrmOW6piArIOWGhei+uei3nVxyXG4gKi9cclxuY29uc3QgZ2V0SGVpZ2h0V2l0aFBhZGRpbmcgPSAoZWxlKSA9PiB7XHJcbiAgcmV0dXJuIGVsZS5jbGllbnRIZWlnaHQ7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiDojrflj5Yg6auY5bqmICsg5YaF6L656LedICsg6L655qGGXHJcbiAqL1xyXG5jb25zdCBnZXRIZWlnaHRXaXRoQm9yZGVyID0gKGVsZSkgPT4ge1xyXG4gIHJldHVybiBlbGUub2Zmc2V0SGVpZ2h0O1xyXG59XHJcblxyXG4vKipcclxuICog6I635Y+WIOmrmOW6piArIOWGhei+uei3nSArIOi+ueahhiArIOWklui+uei3nVxyXG4gKi9cclxuY29uc3QgZ2V0SGVpZ2h0V2l0aE1hcmdpbiA9IChlbGUpID0+IHtcclxuICBsZXQgaGVpZ2h0ID0gZ2V0SGVpZ2h0V2l0aEJvcmRlcihlbGUpLFxyXG4gICAgbXQgPSBnZXRTdHlsZShlbGUsIFwibWFyZ2luLXRvcFwiKSxcclxuICAgIG1iID0gZ2V0U3R5bGUoZWxlLCBcIm1hcmdpbi1ib3R0b21cIik7XHJcbiAgcmV0dXJuIGhlaWdodCArIHRvTnVtYmVyKG10KSArIHRvTnVtYmVyKG1iKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIOiOt+WPluWuveW6plxyXG4gKi9cclxuY29uc3QgZ2V0V2lkdGggPSAoZWxlKSA9PiB7XHJcbiAgbGV0IHdpZHRoID0gZ2V0U3R5bGUoZWxlLCBcIndpZHRoXCIpO1xyXG4gIHJldHVybiB0b051bWJlcih3aWR0aCk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiDojrflj5blrr3luqYgKyDlhoXovrnot51cclxuICovXHJcbmNvbnN0IGdldFdpZHRoV2l0aFBhZGRpbmcgPSAoZWxlKSA9PiB7XHJcbiAgcmV0dXJuIGVsZS5jbGllbnRXaWR0aDtcclxufVxyXG5cclxuLyoqXHJcbiAqIOiOt+WPliDlrr3luqYgKyDlhoXovrnot50gKyDovrnmoYZcclxuICovXHJcbmNvbnN0IGdldFdpZHRoV2l0aEJvcmRlciA9IChlbGUpID0+IHtcclxuICByZXR1cm4gZWxlLm9mZnNldFdpZHRoO1xyXG59XHJcblxyXG4vKipcclxuICog6I635Y+WIOWuveW6piArIOWGhei+uei3nSArIOi+ueahhiArIOWklui+uei3nVxyXG4gKi9cclxuY29uc3QgZ2V0V2lkdGhXaXRoTWFyZ2luID0gKGVsZSkgPT4ge1xyXG4gIGxldCB3aWR0aCA9IGdldFdpZHRoV2l0aEJvcmRlcihlbGUpLFxyXG4gICAgbWwgPSBnZXRTdHlsZShlbGUsIFwibWFyZ2luLWxlZnRcIiksXHJcbiAgICBtciA9IGdldFN0eWxlKGVsZSxcIm1hcmdpbi1yaWdodFwiKTtcclxuICByZXR1cm4gd2lkdGggKyB0b051bWJlcihtbCkgKyB0b051bWJlcihtcik7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiDojrflj5blhYPntKDnmoQgcGFnZVlcclxuICovXHJcbmNvbnN0IHBhZ2VZID0gKGVsZSkgPT4ge1xyXG4gIGxldCB5ID0gMDtcclxuICB3aGlsZShlbGUub2Zmc2V0UGFyZW50KSB7XHJcbiAgICB5ICs9IGVsZS5vZmZzZXRUb3A7XHJcbiAgICBlbGUgPSBlbGUub2Zmc2V0UGFyZW50O1xyXG4gIH1cclxuICByZXR1cm4geTtcclxufVxyXG5cclxuLyoqXHJcbiAqIOiOt+WPluWFg+e0oOeahCBwYWdlWFxyXG4gKi9cclxuY29uc3QgcGFnZVggPSAoZWxlKSA9PiB7XHJcbiAgbGV0IHggPSAwO1xyXG4gIHdoaWxlKGVsZS5vZmZzZXRQYXJlbnQpIHtcclxuICAgIHggKz0gZWxlLm9mZnNldExlZnQ7XHJcbiAgICBlbGUgPSBlbGUub2Zmc2V0UGFyZW50O1xyXG4gIH1cclxuICByZXR1cm4geDtcclxufVxyXG5cclxuLyoqXHJcbiAqXHJcbiAqIOiOt+WPliBzcmMg5ZyoIHRhcmdldCDlhYPntKDph4znmoQgY2xpZW50WFxyXG4gKiBAcGFyYW0gdGFyZ2V0IOebuOWvueeahOWdkOagh+ezu+e7n1xyXG4gKiBAcGFyYW0gc3JjXHJcbiAqL1xyXG5jb25zdCBjbGllbnRYID0gKHRhcmdldCwgc3JjKSA9PiB7XHJcbiAgbGV0IHNyY1ggPSBwYWdlWChzcmMpLFxyXG4gICAgdGFyZ2V0WCA9IHBhZ2VYKHRhcmdldCksXHJcbiAgICBzY3JvbGxYID0gdGFyZ2V0Lm9mZnNldExlZnQgfHwgMDsgLy8g5rKh5pyJ5rua5YqoIHNjcm9sbFggPSAwXHJcbiAgcmV0dXJuIHNyY1ggLSB0YXJnZXRYIC0gc2Nyb2xsWDtcclxufVxyXG5cclxuLyoqXHJcbiAqIOiOt+WPliBzcmMg5ZyoIHRhcmdldCDlhYPntKDph4znmoQgY2xpZW50WVxyXG4gKiBAcGFyYW0gdGFyZ2V0XHJcbiAqIEBwYXJhbSBzcmNcclxuICovXHJcbmNvbnN0IGNsaWVudFkgPSAodGFyZ2V0LCBzcmMpID0+IHtcclxuICBsZXQgc3JjWSA9IHBhZ2VZKHNyYyksXHJcbiAgICB0YXJnZXRZID0gcGFnZVkodGFyZ2V0KSxcclxuICAgIHNjcm9sbFkgPSB0YXJnZXQuc2Nyb2xsVG9wIHx8IDA7ICAgICAvLyDmsqHmnInmu5rliqggc2Nyb2xsWSA9IDBcclxuICByZXR1cm4gc3JjWSAtIHRhcmdldFkgLSBzY3JvbGxZO1xyXG59XHJcblxyXG5leHBvcnQge1xyXG4gIGNsaWVudFgsXHJcbiAgY2xpZW50WSxcclxuICBnZXRIZWlnaHQsXHJcbiAgZ2V0SGVpZ2h0V2l0aFBhZGRpbmcsXHJcbiAgZ2V0SGVpZ2h0V2l0aEJvcmRlcixcclxuICBnZXRIZWlnaHRXaXRoTWFyZ2luLFxyXG4gIGdldFdpZHRoLFxyXG4gIGdldFdpZHRoV2l0aFBhZGRpbmcsXHJcbiAgZ2V0V2lkdGhXaXRoQm9yZGVyLFxyXG4gIGdldFdpZHRoV2l0aE1hcmdpbixcclxuICBwYWdlWCxcclxuICBwYWdlWSxcclxuICBnZXRTdHlsZSxcclxuICB0b051bWJlclxyXG59XHJcbiIsImltcG9ydCB7Y2xpZW50WSwgZ2V0U3R5bGUsIHRvTnVtYmVyfSBmcm9tIFwiLi4vdG9vbHMvaW5kZXhcIjtcclxuXHJcbmNvbnN0IGRlZmF1bHRPcHRpb25zID0ge1xyXG4gIHdyYXBwZWQ6IG51bGwsXHJcbiAgY2hpbGQ6IG51bGwsXHJcbiAgYm9yZGVyOiB0cnVlLFxyXG4gIGZvcndhcmQ6IDAsXHJcbiAgY2I6ICgpID0+IHt9XHJcbn1cclxuY29uc3QgcmVtb3ZlQm9yZGVyID0gKHdyYXBwZWQsIHkpID0+IHtcclxuICBsZXQgYnQgPSBnZXRTdHlsZSh3cmFwcGVkLCBcImJvcmRlci10b3BcIik7XHJcbiAgcmV0dXJuIHkgLSB0b051bWJlcihidCk7XHJcbn1cclxuXHJcbmNvbnN0IGp1ZGdlWSA9ICh5LCBvcHRpb25zKSA9PiB7XHJcbiAgbGV0IHdyYXBwZWQgPSBvcHRpb25zLndyYXBwZWQsXHJcbiAgICBjaGlsZCA9IG9wdGlvbnMuY2hpbGQsXHJcbiAgICBjYWxsYmFjayA9IG9wdGlvbnMuY2IsXHJcbiAgICBib3JkZXIgPSBvcHRpb25zLmJvcmRlcixcclxuICAgIGZvcndhcmQgPSBvcHRpb25zLmZvcndhcmQ7XHJcbiAgeSArPSBmb3J3YXJkO1xyXG4gIGlmKHkgPD0gMCkge1xyXG4gICAgbGV0IG5ld1kgPSB5ICsgKGJvcmRlciA/IGNoaWxkLm9mZnNldEhlaWdodCA6IGNoaWxkLmNsaWVudEhlaWdodCk7XHJcbiAgICBjb25zb2xlLmxvZyhuZXdZKTtcclxuICAgIGlmKG5ld1kgPiAwKSB7XHJcbiAgICAgIGNhbGxiYWNrKGNoaWxkLCB0cnVlKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGNhbGxiYWNrKGNoaWxkLCBmYWxzZSk7XHJcbiAgICB9XHJcbiAgfSBlbHNlIHtcclxuICAgIGlmKHkgPD0gKHdyYXBwZWQuY2xpZW50SGVpZ2h0KSAmJiB5ID49IDIgKiBmb3J3YXJkKSB7XHJcbiAgICAgIGNhbGxiYWNrKGNoaWxkLCB0cnVlKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGNhbGxiYWNrKGNoaWxkLCBmYWxzZSk7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcbmNvbnN0IHNjcm9sbFNob3cgPSAob3B0aW9ucykgPT4ge1xyXG4gIG9wdGlvbnMgPSBPYmplY3QuYXNzaWduKGRlZmF1bHRPcHRpb25zLCBvcHRpb25zKTtcclxuICBsZXQgeSA9IGNsaWVudFkob3B0aW9ucy53cmFwcGVkLCBvcHRpb25zLmNoaWxkKTtcclxuICB5ID0gcmVtb3ZlQm9yZGVyKG9wdGlvbnMud3JhcHBlZCwgeSk7ICAgICAgIC8vIHdyYXBwZWQg5YWD57Sg55qEIGJvcmRlciDlrr3luqbkvJrorqHnrpfov5vljrvvvIzlnKjov5nph4zlh4/mjolcclxuICBqdWRnZVkoeSwgb3B0aW9ucyk7XHJcbn1cclxuZXhwb3J0IGRlZmF1bHQgc2Nyb2xsU2hvdztcclxuXHJcbiJdLCJuYW1lcyI6W10sIm1hcHBp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
